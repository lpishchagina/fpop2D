############################################################################
############################################################################
##                    package instalation                                 ##
############################################################################
############################################################################

devtools::install_github("lpishchagina/fpop2D")
library(fpop2D)
devtools::install_github("lpishchagina/OptPartitioning2D")
library(OptPartitioning2D)


#############################################################################################
#############################################################################################
##        Test1: Values of mean is constant over the interval (0,T1_n) and sigma = 0.      ##
#############################################################################################
#############################################################################################

###############################
#     data generation         #
###############################

#data generation 1
T1_n <- 10
T1_chp <- T1_n
T1_mu1 <- 0
T1_mu2 <- 1
T1_sigma <- 0
T1_penalty <- 2 * T1_sigma * log(T1_n)

T1_data <- data_gen2D(T1_n,T1_chp, T1_mu1, T1_mu2, T1_sigma)
T1_data
#

###################### OptPart ##############################################
T1_OptPart <- OptPart2D(T1_data[1,], T1_data[2,], T1_penalty, type = "null")
T1_OptPart
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#

###################### PELT ##############################################
T1_OptPart <- OptPart2D(T1_data[1,], T1_data[2,], T1_penalty, type = "pruning")
T1_OptPart
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#

###################### FPOP type = 1 #########################################

T1_FPOPt1 <- FPOP2D(T1_data[1,], T1_data[2,], T1_penalty, type = 1)
T1_FPOPt1
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#

###################### FPOP type = 2 #########################################
T1_FPOPt2 <- FPOP2D(T1_data[1,], T1_data[2,], T1_penalty, type = 2)
T1_FPOPt2
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#

#############################################################################################
#############################################################################################
##                                        End Test1                                        ##
#############################################################################################
#############################################################################################


#############################################################################################
#############################################################################################
##        Test2: Data has 2 segments with values of different means(sigma = 0).            ##
#############################################################################################
#############################################################################################

###############################
#     data generation         #
###############################

T2_n <- 10
T2_chp <- c(T2_n/2, T2_n)
T2_mu1 <- c(0, 1)
T2_mu2 <- c(1, 0)
T2_sigma <- 0
T2_penalty <- 2 * T2_sigma * log(T2_n)

T2_data<- data_gen2D(T2_n, T2_chp, T2_mu1,T2_mu2,T2_sigma)
#

###################### OptPart ##############################################
T2_OptPart <- OptPart2D(T2_data[1,], T2_data[2,], T2_penalty, type = "null")
T2_OptPart
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#

###################### PELT ##############################################
T2_OptPart <- OptPart2D(T2_data[1,], T2_data[2,], T2_penalty, type = "pruning")
T2_OptPart
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#

###################### FPOP type = 1 #########################################

T2_FPOPt1 <- FPOP2D(T2_data[1,], T2_data[2,], T2_penalty, type = 1)
T2_FPOPt1
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#

###################### FPOP type = 2 #########################################
T2_FPOPt2 <- FPOP2D(T2_data[1,], T2_data[2,], T2_penalty, type = 2)
T2_FPOPt2
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#


###############################
#      penalty = 0.001        #
###############################

T2_l_penalty <- 0.001 # =>n segments

###################### OptPart ##############################################
T2_l_pen_OptPart<-OptPart2D(T2b_data[1,], T2b_data[2,],T2_l_penalty, type="null")
T2_l_pen_OptPart


###################### PELT     ##############################################
T2_l_pen_PELT <- OptPart2D(T2b_data[1,], T2b_data[2,], T2_l_penalty, type="pruning")
T2_l_pen_PELT


###################### FPOP type = 1 #########################################
T2_l_pen_FPOPt1<- FPOP2D(T2b_data[1,], T2b_data[2,],T2_l_penalty, type = 1)
T2_l_pen_FPOPt1


###################### FPOP type = 2 #########################################
T2_l_pen_FPOPt2 <- FPOP2D(T2b_data[1,], T2b_data[2,], T2_l_penalty, type = 2)
T2_l_pen_FPOPt2


###############################
#      penalty = 10           #
###############################
T2_b_penalty <- 10 # =>1 segment

####################### OptPart ##############################################
T2_b_pen_OptPart<-OptPart2D(T2b_data[1,], T2b_data[2,],T2_b_penalty, type="null")
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#
###################### PELT     ##############################################
T2_b_pen_PELT <- OptPart2D(T2_data[1,], T2b_data[2,], T2_b_penalty, type="pruning")
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#
###################### FPOP type = 1 #########################################
T2_b_pen_FPOPt1<-FPOP2D(T2b_data[1,], T2b_data[2,],T2_b_penalty, type = 1)
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#

###################### FPOP type = 2 #########################################

T2_b_pen_FPOPt2 <- OptPart2D(T2_data[1,], T2b_data[2,], T2_b_penalty, type = 2)
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#


#############################################################################################
#############################################################################################
##                                        End Test2                                        ##
#############################################################################################
#############################################################################################



#############################################################################################
#############################################################################################
##                    Test3: The data has multiple segments (sigma = 1).                   ##
#############################################################################################
#############################################################################################

###############################
#     data generation         #
###############################

T3_n <- 50
T3_chp <- seq(from = 10, to = T3_n, by = 10)
T3_mu1 <- c(1, 5, 2, 0, 8)
T3_mu2 <- c(0, 10, 0, 7, 0)
T3_sigma <- 1
T3_penalty <- 2 * T3_sigma * log(T3_n)

T3_data <- data_gen2D(T3_n, T3_chp, T3_mu1,T3_mu2)
T3_data

###################### OptPart ##############################################
T3_OptPart <- OptPart2D(T3_data[1,], T3_data[2,], T3_penalty, type = "null")
T3_OptPart
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#

###################### PELT ##############################################
T3_OptPart <- OptPart2D(T3_data[1,], T3_data[2,], T3_penalty, type = "pruning")
T3_OptPart
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#

###################### FPOP type = 1 #########################################

T3_FPOPt1 <- FPOP2D(T3_data[1,], T3_data[2,], T3_penalty, type = 1)
T3_FPOPt1
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#

###################### FPOP type = 2 #########################################
T3_FPOPt2 <- FPOP2D(T3_data[1,], T3_data[2,], T3_penalty, type = 2)
T3_FPOPt2
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#



#############################################################################################
#############################################################################################
##                                        End Test3                                        ##
#############################################################################################
#############################################################################################




#############################################################################################
#############################################################################################
##      Test4: Data1 and data2 have different number of segments (sigma = 1).              ##
#############################################################################################
#############################################################################################

###############################
#     data generation         #
###############################

T4_n <- 50
T4_chp <- seq(from = 10, to = T4_n, by = 10)
T4_mu1 <- c(5, 0, 8, 2, 10)
T4_mu2 <- c(0, 0, 5, 1, 0)
T4_sigma <- 1
T4_penalty <- 2 * T4_sigma * log(T4_n)

T4_data <- data_gen2D(T4_n, T4_chp, T4_mu1,T4_mu2,T4_sigma)

###################### OptPart ##############################################
T4_OptPart <- OptPart2D(T4_data[1,], T4_data[2,], T4_penalty, type = "null")
T4_OptPart
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#

###################### PELT ##############################################
T4_OptPart <- OptPart2D(T4_data[1,], T4_data[2,], T4_penalty, type = "pruning")
T4_OptPart
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#

###################### FPOP type = 1 #########################################

T4_FPOPt1 <- FPOP2D(T4_data[1,], T4_data[2,], T4_penalty, type = 1)
T4_FPOPt1
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#

###################### FPOP type = 2 #########################################
T4_FPOPt2 <- FPOP2D(T4_data[1,], T4_data[2,], T4_penalty, type = 2)
T4_FPOPt2
#$changepoints
#
#$means1
#
#$means2
#
#$globalCost
#



#############################################################################################
#############################################################################################
##                                        End Test4                                        ##
#############################################################################################
#############################################################################################